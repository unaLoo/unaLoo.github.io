---
title: 'æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨Jekyllæ­å»ºæˆ‘çš„ä¸ªäººåšå®¢çš„ï¼Ÿï¼ˆä¸€ï¼‰'
date: 2024-04-23
permalink: /posts/buildBlog1/
tags:
  - Jekyll
  - blog
  - docker
---

> ä¸€æ¬¡ä½¿ç”¨ Docker æœ¬åœ°å¯åŠ¨ Jekyll ä¸ªäººåšå®¢ä»¥åŠæœ€ç»ˆåˆ©ç”¨Github Pagesæ‰˜ç®¡çš„å®è·µè¿‡ç¨‹ï¼Œè®°å½•äº†ä¾èµ–å®‰è£…ã€SCSS ç¼–è¯‘ã€linuæ–‡ä»¶å†™å…¥æƒé™ç­‰é—®é¢˜


----


## èƒŒæ™¯

æˆ‘æƒ³åœ¨æœ¬åœ°éƒ¨ç½²ä¸€ä¸ª Jekyll åšå®¢æ¨¡æ¿è¿›è¡Œä¸ªæ€§åŒ–å¼€å‘ï¼Œå› ä¸ºä¸æƒ³æŠ˜è…¾ Windows æœ¬åœ°ç¯å¢ƒå’Œ WSLï¼Œäºæ˜¯æˆ‘é€‰æ‹©äº†ç”¨ Docker æ¥è¿è¡Œ Jekyllã€‚

æ•´ä¸ªè¿‡ç¨‹ä»é›¶å¼€å§‹ï¼Œåˆ°æœ€åæˆåŠŸåœ¨github.ioçœ‹åˆ°åšå®¢é¡µé¢ï¼Œé‡åˆ°ä¸å°‘å‘ï¼Œè®°å½•ä¸€ä¸‹!

## å†ç¨‹

### æ‹‰å–å®˜æ–¹é•œåƒ+æŒ‚è½½+å¯åŠ¨

æˆ‘ä½¿ç”¨çš„æ˜¯å®˜æ–¹é•œåƒ [`jekyll/jekyll`](https://hub.docker.com/r/jekyll/jekyll)ï¼š

```bash
docker pull jekyll/jekyll
```

ç„¶åå¯åŠ¨å®¹å™¨ï¼š

```bash
docker run --rm -v "$PWD:/srv/jekyll" -p 4000:4000 jekyll/jekyll jekyll serve
```

è¿™ä¼šå°†å½“å‰ç›®å½•ï¼ˆä½ çš„jecyllåšå®¢é¡¹ç›®ï¼‰æŒ‚è½½åˆ°å®¹å™¨çš„ `/srv/jekyll`ï¼Œå¹¶åœ¨ 4000 ç«¯å£è¿è¡Œ Jekyll æœåŠ¡

å¯¹çš„ã€‚ç„¶åå°±å¼€å§‹é‡åˆ°é—®é¢˜äº†ã€‚(lllï¿¢Ï‰ï¿¢)

### é‡åˆ°é—®é¢˜ï¼š4000ç«¯å£å ç”¨ï¼Œå®¹å™¨å¯åŠ¨å¤±è´¥

è¿™ä¸ªé—®é¢˜è¿˜æ¯”è¾ƒezï¼Œæœäº†ä¸€ä¸‹ï¼Œä¸‹é¢çš„å‘½ä»¤å¯ä»¥æŸ¥è¯¢4000ç«¯å£å ç”¨æƒ…å†µ

```bash
netstat -ano | findstr :4000
```

æœç„¶æŸ¥åˆ°æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨ç”¨....é‚æ›¿æ¢4001

### æœ‰ç•Œé¢äº†ï¼Œä½†CSSç¼ºå¤±

æ‰“å¼€æµè§ˆå™¨å‘ç°é¡µé¢åŠ è½½å¾ˆæ…¢ä¸”æ ·å¼å…¨ä¹±ï¼Œè°ƒè¯•å‘ç°ï¼š

- é¡¹ç›®ä»£ç ä¸­å¼•ç”¨çš„ CSS å®é™…æ˜¯ SCSS æºæ–‡ä»¶ï¼›
- æ²¡æœ‰æ‰§è¡Œæ„å»ºï¼Œå¯¼è‡´ `_site/` ç›®å½•ä¸­æ²¡æœ‰çœŸæ­£çš„ CSS æ–‡ä»¶è¾“å‡ºã€‚

å•¥æƒ…å†µå‘¢? é¦–å…ˆæ˜¯çœ‹çœ‹åˆ°åº•æœ‰æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œ
äºæ˜¯æˆ‘å°±æƒ³åˆ°ç”¨åå°è¿›ç¨‹è¿è¡ŒjekyllæœåŠ¡ï¼Œå†ç”¨ä¸»è¿›ç¨‹æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿé‡Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚

```bash
nohup jekyll serve --host 0.0.0.0 &
```

å› ä¸ºè¿™ä¸ªå‘½ä»¤ä¼šåœ¨bashçš„å½“å‰è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªlogæ–‡ä»¶ï¼Œè®°å½•æœåŠ¡æ—¥å¿—ä¿¡æ¯, ä½†å®¹å™¨å†…é»˜è®¤ç”¨æˆ·å¯¹æŒ‚è½½ç›®å½•æ²¡æœ‰å†™æƒé™ï¼Œå¯¼è‡´åå°è¿›ç¨‹æŠ¥é”™ã€‚
æ˜¯ä¹å°±é‡åˆ°äº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œ æ²¡æœ‰å†™å…¥æƒé™ï¼Œåå°è¿è¡Œå¤±è´¥

### è§£å†³æƒé™é—®é¢˜

æˆ‘ç›´æ¥ç»™é¡¹ç›®ç›®å½•è®¾ç½®äº† 777 
> 777ï¼šæ˜¯æƒé™çš„æ•°å€¼è¡¨ç¤ºï¼Œç”¨äºè®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„è¯»ï¼ˆreadï¼‰ã€å†™ï¼ˆwriteï¼‰ã€æ‰§è¡Œï¼ˆexecuteï¼‰æƒé™ã€‚ç¬¬ä¸€ä¸ªæ•°å­—ï¼ˆ7ï¼‰ï¼šè¡¨ç¤ºæ‰€æœ‰è€…ï¼ˆownerï¼‰çš„æƒé™ã€‚ç¬¬äºŒä¸ªæ•°å­—ï¼ˆ7ï¼‰ï¼šè¡¨ç¤ºæ‰€å±ç»„ï¼ˆgroupï¼‰çš„æƒé™ã€‚ç¬¬ä¸‰ä¸ªæ•°å­—ï¼ˆ7ï¼‰ï¼šè¡¨ç¤ºå…¶ä»–ç”¨æˆ·ï¼ˆothersï¼‰çš„æƒé™ã€‚æ•°å­— 7 è¡¨ç¤ºæ‹¥æœ‰è¯»ï¼ˆ4ï¼‰ã€å†™ï¼ˆ2ï¼‰å’Œæ‰§è¡Œï¼ˆ1ï¼‰ä¸‰ç§æƒé™ï¼Œå³ rwxã€‚å› æ­¤ï¼Œ777 è¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·ï¼ˆæ‰€æœ‰è€…ã€æ‰€å±ç»„å’Œå…¶ä»–ç”¨æˆ·ï¼‰éƒ½æ‹¥æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚

```bash
chmod -R 777 .
```

ç„¶åjekyllå°±èƒ½æ­£å¸¸å†™å…¥æ–‡ä»¶ï¼Œè·‘èµ·æ¥äº†ã€‚

### SCSSç¼–è¯‘

æœåŠ¡è·‘èµ·æ¥äº†ï¼Œæ ¹æ®æµè§ˆå™¨è¯·æ±‚çš„cssè·¯å¾„è¿›å…¥æ–‡ä»¶ç³»ç»Ÿä¸€çœ‹ï¼Œç¼ºå¤±æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯çœ‹åˆ°äº†SCSSç›¸å…³çš„å†…å®¹ï¼Œé‚£å°±æ˜¯SCSSæ²¡ç¼–è¯‘å‘—

```bash
jekyll build
```

ä¸èµ·ä½œç”¨ï¼Œè€Œä¸”èµ„æ–™æ˜¾ç¤ºï¼Œ`jekyll serve`çš„æ—¶å€™å°±ä¼šåƒwebé¡¹ç›®çš„`npm run dev`ä¸€æ ·ï¼Œä¼šå…ˆç¼–è¯‘å†å¯æœåŠ¡, å†æ¬¡æ‹·æ‰“GPTå‘ç°ï¼Œéœ€è¦å…ˆbundle install

> bundle install æ˜¯ Ruby ç”Ÿæ€ç³»ç»Ÿä¸­ Bundler å·¥å…·çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºå®‰è£…å’Œç®¡ç†é¡¹ç›®ä¾èµ–çš„ RubyGemsï¼ˆRuby çš„åŒ…ç®¡ç†å·¥å…·ï¼‰ã€‚Bundler æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…è½»æ¾ç®¡ç†é¡¹ç›®ä¸­æ‰€éœ€çš„ gemï¼ˆRuby çš„åŒ…ï¼‰åŠå…¶ç‰ˆæœ¬ã€‚
> gem æ˜¯ Ruby çš„åŒ…ç®¡ç†ç³»ç»Ÿï¼Œç±»ä¼¼äº JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­çš„ npmã€‚å®ƒç”¨äºåˆ›å»ºã€åˆ†å‘å’Œç®¡ç† Ruby çš„è½¯ä»¶åŒ…ï¼ˆç§°ä¸º gemï¼‰ã€‚

å™¢~~ åŸæ¥æ˜¯Rubyçš„ä¾èµ–æ²¡å®‰è£…ï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œè¿™ä¹ˆè¯´npmç›¸å½“äºæ˜¯bundle+gemäº†ï¼Œä¸€çœ‹é¡¹ç›®ç›®å½•é‡Œç¡®å®æœ‰ä¸ªGemfileï¼ŒGemfile.lock

```bash
bundle install
# then
jekyll serve --host 0.0.0.0
```

è‡³æ­¤ï¼Œå¯ä»¥åœ¨æœ¬åœ°4001ç«¯å£è®¿é—®åˆ°é»˜è®¤çš„åšå®¢é¡µé¢ï¼Œ æ ·å¼æ­£å¸¸

### ğŸš€ æ›´æ–¹ä¾¿åœ°å¯åŠ¨
ä¸ºäº†æ–¹ä¾¿å¯åŠ¨ï¼Œæˆ‘é…ç½®äº† `docker-compose.yaml` å’Œ `dockerfile` æ–‡ä»¶ï¼š

```yaml
######### docker-compose.yaml #############
services:
  jekyll:
    build: .
    ports:
      - "4001:4000"
    volumes:
      - .:/srv/jekyll
    environment:
      JEKYLL_ENV: docker
```

```dockerfile
# Base image
FROM jekyll/jekyll:latest

# Set the working directory
WORKDIR /srv/jekyll

# Copy the current directory contents into the container
COPY . .

# Bundle install !!!
RUN bundle install

# Command to serve the Jekyll site
CMD ["jekyll", "serve", "-H", "0.0.0.0", "-w", "--config", "_config.yml,_config_docker.yml"]
```

å¯åŠ¨å‘½ä»¤ä¹Ÿå˜å¾—éå¸¸ç®€æ´ï¼š

```bash
docker-compose up
```

## ä¿®æ”¹ configå’Œä»£ç çš„çƒ­æ›´æ–°ï¼Ÿ

### Qï¼šä¿®æ”¹äº† `_config.yml` è¦é‡å¯å®¹å™¨å—ï¼Ÿ

Aï¼šä¸éœ€è¦é‡å»ºé•œåƒï¼Œä¹Ÿä¸éœ€è¦é‡å»ºå®¹å™¨ï¼Œåªè¦ä¿å­˜åé‡å¯æœåŠ¡å³å¯ã€‚

```bash
docker-compose restart
```

## æœ€ç»ˆæ•ˆæœ

æˆåŠŸè®¿é—® `http://localhost:4001`ï¼Œçœ‹åˆ°åšå®¢é¡µé¢ï¼

```bash
docker-compose up
# æµè§ˆå™¨è®¿é—® localhost:4001
```

## åç»­è®¡åˆ’

- âœ… æ·»åŠ ä¸ªäººä¸»é¡µå†…å®¹
- âœ… ä¼˜åŒ–åšå®¢å¯¼èˆªæ ç»“æ„

## æ€»ç»“

è¿™æ¬¡ç”¨ Docker å¯åŠ¨ Jekyll çš„ç»å†è®©æˆ‘å¯¹Rubyé¡¹ç›®ã€dockeræœ‰äº†æ›´æ¸…æ™°çš„äº†è§£ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ï¼š

- âœ… æƒé™é—®é¢˜ â†’ chmod 777
- âœ… SCSS æœªç¼–è¯‘ â†’ jekyll build
- âœ… ä¾èµ–æœªå®‰è£… â†’ bundle install
- âœ… å®¹å™¨å¿«é€Ÿå¯åŠ¨ â†’ docker-compose

---

å¦‚æœä½ ä¹Ÿæƒ³ç”¨ Jekyll + Docker éƒ¨ç½²è‡ªå·±çš„åšå®¢ï¼Œå¸Œæœ›è¿™ç¯‡è¸©å‘è®°å½•å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼