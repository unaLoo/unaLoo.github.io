---
title: 'DOM API'
date: 2025-07-28
tags:
  - JavaScript
---


# DOM API

## DOM

DOM (Document Object Model， 文档对象模型)是 JS 操作网页的接口。   
浏览器将结构化文档 (HTML, XML) 解析为一系列的节点，形成树状结构（DOM Tree），并且提供了标准的对外接口。


## 节点

DOM Tree 由不同类型的节点构成，包括 7 类, 都继承自 `Node` 对象：
- `Document` 整个树的顶层节点
- `DocumentType` 即 doctype 标签节点
- `Element` 各种 HTML 标签
- `Attr` 网页元素的属性
- `Text` 标签之间或内部的文本
- `Comment` 注释
- `DocumentFragment` 文档片段


浏览器原生提供的 `document` 节点，代表了整个文档对象树。它的第一层有两个节点，一个`doctype`，一个`html`,后者构成了树结构的根节点。


不同的节点之间有三种关系：
- parentNode
- childNodes
- sibling
  

对于一个 DOM 节点，自带了`lastChild` `nextSibling` 等接口以获取目标节点。


## Node 接口

所有 DOM 节点都继承了 Node 接口，Node 接口提供了一些共同的属性和方法。

### 属性

| 属性名 | 描述 |
| --- | --- |
| `el.nodeType` | 返回一个枚举常量整数值，表示节点类型，包阔上一节提供的节点类型。 |
| `el.nodeName` | 返回节点名称，元素节点的话就是标签名称，其他的就是 `#` + 类型，比如 `#text`  `#document-fragment` |
| `el.nodeValue` | 只有 `text` `comment` `attr` 三类节点有值，返回文本值 |
| `el.textContent` | 返回节点内部的(包括子节点)的文本内容，**忽略** HTML 标签，该属性可读可写 |
| `el.baseURI` | 表示当前网页的绝对路径 |
| `el.ownerDocument` | 返回当前节点所在的顶层文档对象，即 document 对象 |
| `el.nextSibling` | 下一个兄弟 |
| `el.previousSibling` | 上一个兄弟 |
| `el.parentNode` | 父节点，可能时 element, document, documentFragment |
| `el.parentElement` | 父元素节点，如果无父或非 element，则 null |
| `el.firstChild` / `lastChild`  |  子节点 |
| `el.childNodes` | 返回子节点组成的 类数组对象 NodeList 集合|  |


### 方法

| 方法名 | 描述 |
| --- | --- |
| `el.appendChild()` | 将参数节点对象插入至当前节点末尾， 如果插入一个文档片段，那插入的是片段中的所有子节点 |
| `el.hasChildNodes()` | 当前节点是否有子节点 |
| `el.cloneNode()` | 克隆节点 |
| `el.insertBefore()` | 在给定的子节点之前插入新子节点 |
| `el.removeChild()` | 删除指定子节点 |
| `el.replaceChild()` | 替换指定子节点 |
| `el.contain()` | 判断参数节点是否是当前节点或后代节点 |
| `el.isEqualNode()` | 判断节点是否相等 |


## NodeList 与 HTMLCollection

`NodeList` 和 `HTMLCollection` 都是类数组对象，存储了多个节点， 可以用`Array.prototype.slice.call`来转为真数组，区别在于，`NodeList` 可包含各种类型的节点，而 `HTMLCollection` 只能包含 HTML Element 节点。


`el.childNodes` 和 `querySelectAll` 的返回值都是 NodeList


返回 HTMLCollection 实例的，主要是一些 Document 对象的集合属性，比如`document.links`、`document.forms`、`document.images`等。


## ParentNode 接口 与 ChildNode 接口

`Mixin`（混入） 是一种编程设计模式，用于在不使用完整继承的情况下，向类中添加可复用的功能。它通常是一个提供特定方法或行为的类，但不独立使用，也不代表一个完整的“类型”。多重继承是 `Mixin `的一种实现，是一种**受控的、有约束的多重继承**。 


当一个节点有子子节点，那么它就 mixin 了 ParentNode 接口；同理，一个子节点被加到一个父节点之下，那么它也 mixin 了 `childNode`


ParentNode 接口提供的属性方法：

| 属性和方法 | 描述 |
| --- | --- |
| children | 返回子节点 HTMLCollection | 
| firstElementChild | --- | 
| lastElementChild | --- |
| childElementCount | --- |
| append | 尾部追加 |
| prepend | 在头部加 |


ChildNode 接口提供的属性方法：

| 属性和方法 | 描述 |
| --- | --- |
| remove | 直接把自己自己从父节点中移除 | 
| before | 在节点前面插入兄弟 | 
| after | 在节点后面插入兄弟 |
| replaceWith | --- |


## Document 节点

获取 document ： 
- document
- iframe 节点的 **contentDocument**
- ownerDocument

### 属性

**快捷方式属性**：直接获取某些特定节点， 比如
- document.doctype
- document.body
- document.fullscreenElement


**节点集合属性**：直接获取特定元素的节点集合，比如
- document.links
- document.image
- document.forms
  

**静态信息属性**：返回文档信息，比如
- document.documentURI  返回当前网页地址
- document.domain  返回域名，不包含协议和端口
- document.location   返回一个 Location 对象，包含域名、 URI 、协议等等信息
- document.lastModified 
- document.title 


**文档状态属性**：
- `document.hidden` 如页面最小化，或者切换到其他标签页了，都会返回 true
- `document.visibilityState` 
  - visible 可见
  - hidden 不可见
  - prerender 正在渲染，不可见
  - unloaded 页面已卸载
- `document.readyState`  包括  loading  interactive  complete
  - 浏览器开始下载和解析 HTML 文档，`loading`。
  - 遇到 HTML 文档中的`<script>`元素，并且没有async或defer属性，就暂停解析，开始执行脚本，这时还是 `loading`。
  - HTML 文档解析完成，document.readyState属性变成`interactive`。
  - 浏览器等待图片、样式表、字体文件等外部资源加载完成，一旦全部加载完成，`complete`。
- `document.cookie` 操作浏览器 cookie
- `document.currentScript` 当前脚本所在的 DOM 节点
- `document.implementation` 创建新的`Document对象`


### 方法

**清朝的 API**
现在都是用 innerHTML， textContent了，了解即可。


- `document.open()` 清除 document 的所有内容，进入可写状态
- `document.write()` 可以向文档写入内容
- `document.close()` 关闭文档，不可写

---


**选择元素**

- document.querySelector() / document.querySelectorAll() --> NodeList
- `document.getElementsByTagName()`  -->  HTMLCollection
- `document.getElementsByClassName()`   -->  HTMLCollection
- `document.getElementsByName() `
- `document.getElementsById()`
- `document.elementFromPoint(x,y)` 返回位于 x , y 处的最上层的元素节点


--- 


**创建元素**

- `document.createElement(tagName)`
- `document.createTextNode() `  --> 在展示用户输入的时候，可以用这个函数确保代码是纯文本渲染，对于特殊字符会转义，避免XSS攻击
- `document.createAttribute()`  --> 一般都是直接给元素 setAttribute, 不需要创建属性节点这样绕路
- `document.createComment()`
- `document.createDocumentFragment()`


--- 


**事件**

- document.createEvent() / document.dispatchEvent()
- document.addEventListener()，document.removeEventListener()


--- 

**跨document的**
- `document.adoptNode()` 把节点从原来所在的文档或文档片段中**移除**，**归属**到当前 document 对象，只是改变归属，但没有插入
- `document.importNode()` 从原来的文档或片段中**拷贝**，归属到当前 document 对象，也没有插入


---


**文档遍历**
- `document.createNodeIterator()` 创建子节点遍历器，遍历器包括 nextNode() previousNode() 等方法
- `document.createTreeWalker()`  类似
  

**文档命令**

如果`document.designMode`属性设为`on`，那么整个文档用户可编辑；如果元素的`contenteditable`属性设为`true`，那么该元素可编辑。   
这两种情况下，可以使用`document.execCommand()`方法，改变内容的样式，比如`document.execCommand('bold')`会使得字体加粗。

- `document.execCommand()`
- `document.queryCommandSupported()`
- `document.queryCommandEnabled()`