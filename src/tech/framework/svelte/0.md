---
title: 'Svelte-åŸºç¡€ç¯‡'
date: 2025-08-27
tags:
  - å‰ç«¯æ¡†æ¶

---

# Svelte-åŸºç¡€ç¯‡

å¦‚ Reactã€Vue ç­‰æ¡†æ¶æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡è™šæ‹Ÿ DOM è¿›è¡Œå·®å¼‚å¯¹æ¯”ï¼Œç„¶åæ›´æ–°çœŸå® DOMã€‚       
è€Œ Svelte çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ç¼–è¯‘æ—¶å°±**æŠŠç»„ä»¶ä»£ç è½¬æ¢æˆé«˜æ•ˆã€å‘½ä»¤å¼çš„ JavaScript ä»£ç **ï¼Œç›´æ¥æ“ä½œçœŸå® DOMã€‚

[å“åº”å¼ / æ·±åº¦çŠ¶æ€ â€¢ Svelte](https://svelte.yayujs.com/tutorial/svelte/deep-state)

## åŸºç¡€

å¤§æ¦‚è¿‡äº†ä¸€ä¸‹ Svelteçš„åŸºç¡€æ•™ç¨‹ï¼š
 - `.svelte` å•æ–‡ä»¶ç»„ä»¶ï¼Œç±»HTMLï¼Œ
 - åŠ¨æ€å±æ€§ã€æ ·å¼ 
 - åµŒå¥—ç»„ä»¶
### çŠ¶æ€

- `$state`å“åº”å¼çŠ¶æ€ï¼š`let numbers = $state([1, 2]);`,ä¹Ÿæ˜¯é€šè¿‡ proxy å®ç°
- `$derived`æ´¾ç”ŸçŠ¶æ€ï¼š`$derived(numbers.reduce((t, n) => t + n, 0));`ç±»ä¼¼computed
- `$effect`ï¼šÂ Svelte æ›¿ä½ åˆ›å»ºçš„ã€å“åº”çŠ¶æ€å˜åŒ–è€Œæ›´æ–° DOMï¼Œè¿™å°±æ˜¯ä¸€ä¸ª effect â€” ä½†ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Â `$effect`Â ç¬¦æ–‡åˆ›å»ºè‡ªå·±çš„ effectï¼Œè¿™ä¸ªæœ‰ç‚¹åƒ useEffectï¼Œä¹Ÿæœ‰ç‚¹åƒ vue3 watchï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°
### props

- `$props()`: åœ¨å­ç»„ä»¶ä¸­æ˜¾å¼å£°æ˜æ¥æ”¶æ¥è‡ªçˆ¶ç»„ä»¶çš„ props

### é€»è¾‘å—

**1 æ¡ä»¶ if else**
```svelte
{#if count > 10} 
	<p>{count} is greater than 10</p> 
{:else if count < 5}
	<p>{count} is less than 5</p>
{:else}
	<p>{count} is between 5 and 10</p> 
{/if}
```

**2 éå† each**
```svelte
<div>
	{#each colors as color, i}
		<button
			style="background: {color}"
			aria-label={color}
			aria-current={selected === color}
			onclick={() => selected = color}
		>{i + 1}</button>
	{/each}
</div>
```

[é€»è¾‘ / å¸¦é”®çš„ each å— â€¢ Svelte æ•™ç¨‹](https://svelte.yayujs.com/tutorial/svelte/keyed-each-blocks)
Svelte çš„å·¥ä½œæ–¹å¼ä¸åŒï¼šç»„ä»¶åªâ€è¿è¡Œâ€ä¸€æ¬¡ï¼Œåç»­æ›´æ–°æ˜¯â€ç»†ç²’åº¦çš„â€ã€‚è¿™ä½¿å¾—æ“ä½œæ›´å¿«ï¼Œå¹¶ç»™ä½ æ›´å¤šæ§åˆ¶æƒã€‚
å¯ä»¥çœ‹è¿™ä¸ªä¾‹å­ï¼Œå®ƒä¸åƒ react é‚£æ ·ï¼Œprops å˜äº†å°±é‡æ–°æ¸²æŸ“

**3 å¼‚æ­¥ Await ä»£ç å—**
```svelte
{#await promise}
	<p>...rolling</p>
{:then number}
	<p>you rolled a {number}!</p>
{:catch error}
	<p style="color: red">{error.message}</p>
{/await}
```

### äº‹ä»¶

1 å°å†™é£æ ¼ `onpointermove` 
```svelte
<div onpointermove={onpointermove}>
	The pointer is at {Math.round(m.x)} x {Math.round(m.y)}
</div>
```

2 äº‹ä»¶æ•è· `onkeydowncapture` äº‹ä»¶æ•è·ï¼Œåœ¨äº‹ä»¶åç§°ååŠ  capture

3 äº‹ä»¶å›è°ƒå¯ä»¥é€šè¿‡ props ä¼ é€’ï¼Œå’Œ `react` å·®ä¸å¤šï¼Œåœ¨å•é¡¹æ•°æ®æµçš„åŸºç¡€ä¸Šå®ç°å­ç»„ä»¶è§¦å‘çˆ¶ç»„ä»¶æ›´æ–°ã€‚vueé‡Œè¾¹ä¹Ÿå¯ä»¥è¿™æ ·å¹²ï¼Œä½†æ›´æ¨èçš„æ–¹å¼æ˜¯åŸºäºäº‹ä»¶çš„æ–¹å¼ï¼Œå­ç»„ä»¶å‘å‡ºè‡ªå®šä¹‰äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ç”±çˆ¶ç»„ä»¶è‡ªå·±æ¥åšæ›´æ–°ã€‚

### ç»‘å®š

è¿™é‡Œå°±ç´§æ¥ç€ä¸Šæ–‡äº†ï¼Œé€šå¸¸æ¥è¯´ï¼Œä¼—å¤šæ¡†æ¶éƒ½æ˜¯è‡ªä¸Šè€Œä¸‹çš„å•å‘æ•°æ®æµã€‚çˆ¶ç»„ä»¶ä¸ºå­ç»„ä»¶è®¾ç½® `props`ï¼Œç»„ä»¶ä¸ºå…ƒç´ è®¾ç½® `props`, åè¿‡æ¥å°±æ˜¯ä¸åˆé€‚çš„ã€‚

æˆ‘ä»¬è¿™é‡Œåªè®¨è®ºç»„ä»¶å’Œå…ƒç´ çš„è¿™å±‚å…³ç³»ï¼Œvue ä¸­å°±æœ‰äº†`v-model`æ¥å®ç°åŒå‘ç»‘å®šï¼Œå¸¸è§çš„åº”ç”¨å¸¸è§å°±æ˜¯ `input` çš„ `value` å’ŒæŸä¸ªå˜é‡çš„ç»‘å®šã€‚

å¦‚æœæ²¡æœ‰ `v-model`,æˆ‘ä»¬æƒ³å®ç°è¿™ä¸ª `input value` å’Œ `çŠ¶æ€å˜é‡` çš„åŒæ­¥ï¼Œé‚£æˆ‘ä»¬è¦åœ¨ç»™ dom åŠ ä¸€ä¸ª `oninput`, åœ¨valueå˜åŒ–æ—¶åŒæ­¥æ›´æ–°çŠ¶æ€å˜é‡ï¼ŒåŒæ—¶ï¼Œåœ¨è®¾ç½®çŠ¶æ€å˜é‡æ—¶ï¼Œä¹Ÿè¦ç´§æ¥ç€åŒæ­¥æ›´æ–° value å€¼ã€‚

è¿™æ˜¯ä¸€ä¸ªç¹çä¸”é‡å¤çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ `svelte` ä¹Ÿæä¾›äº†è¿™ç§åŒå‘ç»‘å®šçš„èƒ½åŠ›ã€‚
Â `name`Â å€¼çš„æ”¹å˜ä¼šæ›´æ–°è¾“å…¥å€¼ï¼Œè¾“å…¥å€¼çš„æ”¹å˜ä¹Ÿä¼šæ›´æ–°Â `name`ã€‚
Â 
```svelte
## æ–‡æœ¬
<input bind:value={name}>

## æ•°å­—ï¼Œå†…ç½®äº†string ä¸ numberè½¬æ¢çš„å¤„ç†
<input type="number" bind:value={a} min="0" max="10" />
<input type="range" bind:value={a} min="0" max="10" />

## å¤é€‰æ¡†
<input type="checkbox" bind:checked={yes}>


## select
<select
	bind:value={selected}
	onchange={() => answer = ''}
>
```
### class å’Œ style

å’Œ JSX ä¸€æ ·ï¼Œ{} å†…çš„éƒ½ä¼šè¢«å½“ JS å¤„ç†
 
`class="card {flipped ? 'flipped' : ''}"`
`class={["card", { flipped }]}`


`style="transform: {flipped ? 'rotateY(0)' : ''}; --bg-1: palegoldenrod; --bg-2: black; --bg-3: goldenrod"`

ç‰¹æ®Šçš„ï¼Œ`style:` 
```
style:transform={flipped ? 'rotateY(0)' : ''} 
style:--bg-1="palegoldenrod" 
style:--bg-2="black" 
style:--bg-3="goldenrod"
```

### actions

Action æœ¬è´¨ä¸Šæ˜¯å…ƒç´ çº§åˆ«çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚

action å¯ä»¥æ‹“å±•å…ƒç´ çš„ä¸€äº›è¡Œä¸ºï¼Œå®˜ç½‘é‡Œå†™äº†ä¸€ä¸ª trapFocusï¼Œå½“æŒ‰ä¸‹ tab é”®æ—¶ï¼Œè®©å…ƒç´ è‡ªåŠ¨è·å–ç„¦ç‚¹ã€‚

```js
export function trapFocus(node) {
	// node æ˜¯ç»‘å®šçš„domå…ƒç´ 
	const previous = document.activeElement;

	function focusable() {}

	function handleKeydown(event) {}

	$effect(() => {
		focusable()[0]?.focus();
		node.addEventListener('keydown', handleKeydown);
		// æ¸…é™¤å›è°ƒï¼Œé‡Šæ”¾èµ„æº
		return () => {
			node.removeEventListener('keydown', handleKeydown);
			previous?.focus();
		};
	});
}
```

åœ¨ä½¿ç”¨æ—¶ï¼š
```svelte
<div class="menu" use:trapFocus>
```

æ¡ˆä¾‹äºŒï¼Œæ¥å—å†…å®¹ç”Ÿäº§å‡½æ•°çš„tooltip action
```js
function tooltip(node, fn) {
	$effect(() => {
		const tooltip = tippy(node, fn());
		return tooltip.destroy;
	});
}
```

```svelte
<button use:tooltip={() => ({ "ğŸ˜„" })}> Hover me </button>
```
